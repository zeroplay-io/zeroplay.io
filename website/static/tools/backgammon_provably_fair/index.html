<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<title>Fairness Verifier</title>
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<style>
		:root {
			--bg: #111;
			--panel: #1e1e1e;
			--txt: #e8e8e8;
			--accent: #3dcf8f;
			--err: #ff5555;
			--font: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
		}

		* {
			box-sizing: border-box;
			font-family: var(--font);
			margin: 0;
			padding: 0
		}

		body {
			background: var(--bg);
			color: var(--txt);
			display: flex;
			justify-content: center;
			align-items: flex-start;
			min-height: 100vh;
			padding: 24px
		}

		#wrapper {
			width: 100%;
			max-width: 720px;
			background: var(--panel);
			border-radius: 12px;
			padding: 24px;
			box-shadow: 0 4px 18px rgba(0, 0, 0, .3)
		}

		h1 {
			font-size: 1.4rem;
			margin-bottom: 12px;
			text-align: center
		}

		textarea {
			width: 100%;
			min-height: 200px;
			background: #000;
			border: 1px solid #333;
			color: #bfbfbf;
			font: 14px/1.4 monospace;
			padding: 12px;
			border-radius: 8px;
			resize: vertical
		}

		button {
			margin-top: 16px;
			width: 100%;
			padding: 12px 0;
			font-size: 1rem;
			font-weight: 600;
			background: var(--accent);
			color: #000;
			border: none;
			border-radius: 8px;
			cursor: pointer;
			transition: filter .15s;
		}

		button:hover {
			filter: brightness(1.1)
		}

		pre {
			margin-top: 16px;
			white-space: pre-wrap;
			word-break: break-all;
			background: #000;
			color: var(--txt);
			padding: 12px;
			border-radius: 8px;
			min-height: 2.2em
		}

		.bad {
			color: var(--err)
		}

		.good {
			color: var(--accent)
		}

		footer {
			margin-top: 24px;
			font-size: .8rem;
			text-align: center;
			opacity: .6
		}

		a {
			color: var(--accent);
			text-decoration: none
		}

		a:hover {
			filter: brightness(1.15)
		}

	</style>
</head>

<body>
	<div id="wrapper">
		<h1>Backgammon&nbsp;Provably-Fair&nbsp;Verifier</h1>

		<textarea id="input" placeholder="Copy or drag report file to here"></textarea>
		<button id="btn">Verify</button>
		<pre id="out"></pre>

		<footer>Offline Running · Provably Fair · <a href="https://github.com/gopherd/backgammon_provably_fair"
				target="_blank" rel="noopener"><strong>Open Source</strong></a></footer>
	</div>

	<script src="wasm_exec.js"></script>
	<script>
		/* ------- Go → WASM runtime bootstrap ------- */
		const go = new Go();
		WebAssembly.instantiateStreaming(fetch("verifier.wasm"), go.importObject)
			.then(r => go.run(r.instance));

		/* ------- UI helpers ------- */
		const $ = id => document.getElementById(id);
		$("btn").onclick = run;

		$("input").addEventListener('dragover', e => {e.preventDefault();});
		$("input").addEventListener('drop', e => {
			e.preventDefault();
			if (!e.dataTransfer.files.length) return;
			const f = e.dataTransfer.files[0];
			f.text().then(t => {$("input").value = t;});
		});

		/* ------- call verify(json) exported by Go ------- */
		function run() {
			$("out").textContent = "Verifying…";
			try {
				const res = verify($("input").value);
				$("out").textContent = res;
				$("out").className = res == "OK" ? "good" : "bad";
			} catch (err) {
				$("out").textContent = "Error: " + err;
				$("out").className = "bad";
			}
		}
	</script>
</body>

</html>
